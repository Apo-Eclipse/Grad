{
    "Query_1_Top_spending_categories_per_hour": "SELECT Hour, Category, MAX(total_spent) AS max_spending\nFROM (\n    SELECT Hour, Category, SUM(Amount_EGP) AS total_spent\n    FROM transactions_table\n    GROUP BY Hour, Category\n) sub\nGROUP BY Hour;",
    "Query_2_Maximum_spending_category_per_day_of_week": "SELECT Name_of_day, Category, MAX(total_spent) AS max_spending\nFROM (\n    SELECT Name_of_day, Category, SUM(Amount_EGP) AS total_spent\n    FROM transactions_table\n    GROUP BY Name_of_day, Category\n) sub\nGROUP BY Name_of_day;",
    "Query_3_Percentage_of_total_spending_by_category": "SELECT Category,\n    ROUND(100.0 * SUM(Amount_EGP) / (SELECT SUM(Amount_EGP) FROM transactions_table), 2) AS pct_of_total\nFROM transactions_table\nGROUP BY Category\nORDER BY pct_of_total DESC;",
    "Query_4_Percentage_of_total_spending_by_type": "SELECT Type_spending,\n    ROUND(100.0 * SUM(Amount_EGP) / (SELECT SUM(Amount_EGP) FROM transactions_table), 2) AS pct_of_total\nFROM transactions_table\nGROUP BY Type_spending\nORDER BY pct_of_total DESC;",
    "Query_5_Top_spending_categories_per_neighborhood": "SELECT Neighborhood, Category, MAX(total_spent) AS max_spending\nFROM (\n    SELECT Neighborhood, Category, SUM(Amount_EGP) AS total_spent\n    FROM transactions_table\n    GROUP BY Neighborhood, Category\n) sub\nGROUP BY Neighborhood;",
    "Query_6_Top_spending_stores_per_neighborhood": "WITH ranked AS (\nSELECT Neighborhood, Store_Name,\n        SUM(Amount_EGP) AS total_spent,\n        ROW_NUMBER() OVER (PARTITION BY Neighborhood ORDER BY SUM(Amount_EGP) DESC) AS rnk\nFROM transactions_table\nGROUP BY Neighborhood, Store_Name\n)\nSELECT Neighborhood, Store_Name, total_spent\nFROM ranked\nWHERE rnk = 1;",
    "Query_7_Top_spending_stores_per_hour": "WITH store_spend AS (\nSELECT Hour, Store_Name, SUM(Amount_EGP) AS total_spent\nFROM transactions_table\nGROUP BY Hour, Store_Name\n),\nranked AS (\nSELECT Hour, Store_Name, total_spent,\n        ROW_NUMBER() OVER (PARTITION BY Hour ORDER BY total_spent DESC) AS rnk\nFROM store_spend\n)\nSELECT Hour, Store_Name, total_spent\nFROM ranked\nWHERE rnk = 1\nORDER BY Hour;",
    "Query_8_Top_neighborhoods_per_hour": "WITH hood_spend AS (\n    SELECT Hour, Neighborhood, SUM(Amount_EGP) AS total_spent\n    FROM transactions_table\n    GROUP BY Hour, Neighborhood\n),\nranked AS (\n    SELECT Hour, Neighborhood, total_spent,\n        ROW_NUMBER() OVER (PARTITION BY Hour ORDER BY total_spent DESC) AS rnk\n    FROM hood_spend\n)\nSELECT Hour, Neighborhood, total_spent\nFROM ranked\nWHERE rnk = 1\nORDER BY Hour;",
    "Query_9_get_personal_data": "SELECT\n  User_ID,\n  Name,\n  Age,\n  Gender,\n  Job_Title,\n  Employment_Status,\n  Education,\n  Marital_Status,\n  Address,\n  Income_EGP\nFROM user_table\nWHERE User_ID = 1;"
}